#include "stdlib.h"

#define MTX_SIZE (30)
#define MAX_CONFIG 2


typedef size_t physaddr_t;

typedef struct {
	size_t bank;
	size_t row;
	size_t col;
} DRAMAddr;

typedef struct {
  size_t BK_SHIFT;
  size_t BK_MASK;
  size_t ROW_SHIFT;
  size_t ROW_MASK;
  size_t COL_SHIFT;
  size_t COL_MASK;
  size_t DRAM_MTX[MTX_SIZE];
  size_t ADDR_MTX[MTX_SIZE];
} MemConfiguration;


//---------------------------------------------------

int init_lib(unsigned int config);

size_t to_addr(DRAMAddr d); 

DRAMAddr to_dram(size_t p);

size_t linearize(DRAMAddr d); 


//---------------------------------------------------
// 		STATIC MATRICES

MemConfiguration Configurations[MAX_CONFIG] = 
{
	{
         .BK_SHIFT =  26,
         .BK_MASK =  (0b1111),
         .ROW_SHIFT =  0,
         .ROW_MASK =  (0b1111111111111),
         .COL_SHIFT =  13,
         .COL_MASK =  (0b1111111111111),
         .DRAM_MTX =  {
		 0b000000000000000010000001000000,
		 0b000000000000100100000000000000,
		 0b000000000001001000000000000000,
		 0b000000000010010000000000000000,
		 0b000000000000000010000000000000,
		 0b000000000000000001000000000000,
		 0b000000000000000000100000000000,
		 0b000000000000000000010000000000,
		 0b000000000000000000001000000000,
		 0b000000000000000000000100000000,
		 0b000000000000000000000010000000,
		 0b000000000000000000000000100000,
		 0b000000000000000000000000010000,
		 0b000000000000000000000000001000,
		 0b000000000000000000000000000100,
		 0b000000000000000000000000000010,
		 0b000000000000000000000000000001,
		 0b100000000000000000000000000000,
		 0b010000000000000000000000000000,
		 0b001000000000000000000000000000,
		 0b000100000000000000000000000000,
		 0b000010000000000000000000000000,
		 0b000001000000000000000000000000,
		 0b000000100000000000000000000000,
		 0b000000010000000000000000000000,
		 0b000000001000000000000000000000,
		 0b000000000100000000000000000000,
		 0b000000000010000000000000000000,
		 0b000000000001000000000000000000,
		 0b000000000000100000000000000000},
         .ADDR_MTX =  {
		 0b000000000000000001000000000000,
		 0b000000000000000000100000000000,
		 0b000000000000000000010000000000,
		 0b000000000000000000001000000000,
		 0b000000000000000000000100000000,
		 0b000000000000000000000010000000,
		 0b000000000000000000000001000000,
		 0b000000000000000000000000100000,
		 0b000000000000000000000000010000,
		 0b000000000000000000000000001000,
		 0b000000000000000000000000000100,
		 0b000000000000000000000000000010,
		 0b000000000000000000000000000001,
		 0b000100000000000000000000000100,
		 0b001000000000000000000000000010,
		 0b010000000000000000000000000001,
		 0b000010000000000000000000000000,
		 0b000001000000000000000000000000,
		 0b000000100000000000000000000000,
		 0b000000010000000000000000000000,
		 0b000000001000000000000000000000,
		 0b000000000100000000000000000000,
		 0b000000000010000000000000000000,
		 0b100010000000000000000000000000,
		 0b000000000001000000000000000000,
		 0b000000000000100000000000000000,
		 0b000000000000010000000000000000,
		 0b000000000000001000000000000000,
		 0b000000000000000100000000000000,
		 0b000000000000000010000000000000}
     },
     {
         .BK_SHIFT =  25,
         .BK_MASK =  (0b11111),
         .ROW_SHIFT =  0,
         .ROW_MASK =  (0b111111111111),
         .COL_SHIFT =  12,
         .COL_MASK =  (0b1111111111111),
         .DRAM_MTX =  {
		 0b000000000000000010000001000000,
		 0b000000000001000100000000000000,
		 0b000000000010001000000000000000,
		 0b000000000100010000000000000000,
		 0b000000001000100000000000000000,
		 0b000000000000000010000000000000,
		 0b000000000000000001000000000000,
		 0b000000000000000000100000000000,
		 0b000000000000000000010000000000,
		 0b000000000000000000001000000000,
		 0b000000000000000000000100000000,
		 0b000000000000000000000010000000,
		 0b000000000000000000000000100000,
		 0b000000000000000000000000010000,
		 0b000000000000000000000000001000,
		 0b000000000000000000000000000100,
		 0b000000000000000000000000000010,
		 0b000000000000000000000000000001,
		 0b100000000000000000000000000000,
		 0b010000000000000000000000000000,
		 0b001000000000000000000000000000,
		 0b000100000000000000000000000000,
		 0b000010000000000000000000000000,
		 0b000001000000000000000000000000,
		 0b000000100000000000000000000000,
		 0b000000010000000000000000000000,
		 0b000000001000000000000000000000,
		 0b000000000100000000000000000000,
		 0b000000000010000000000000000000,
		 0b000000000001000000000000000000
	 },
         .ADDR_MTX =  {
		 0b000000000000000000100000000000,
		 0b000000000000000000010000000000,
		 0b000000000000000000001000000000,
		 0b000000000000000000000100000000,
		 0b000000000000000000000010000000,
		 0b000000000000000000000001000000,
		 0b000000000000000000000000100000,
		 0b000000000000000000000000010000,
		 0b000000000000000000000000001000,
		 0b000000000000000000000000000100,
		 0b000000000000000000000000000010,
		 0b000000000000000000000000000001,
		 0b000010000000000000000000001000,
		 0b000100000000000000000000000100,
		 0b001000000000000000000000000010,
		 0b010000000000000000000000000001,
		 0b000001000000000000000000000000,
		 0b000000100000000000000000000000,
		 0b000000010000000000000000000000,
		 0b000000001000000000000000000000,
		 0b000000000100000000000000000000,
		 0b000000000010000000000000000000,
		 0b000000000001000000000000000000,
		 0b100001000000000000000000000000,
		 0b000000000000100000000000000000,
		 0b000000000000010000000000000000,
		 0b000000000000001000000000000000,
		 0b000000000000000100000000000000,
		 0b000000000000000010000000000000,
		 0b000000000000000001000000000000
	 }
     }
};


